var tb_position,ThemeViewer,ThemeScroller;jQuery(function(n){n("#availablethemes").on("click",".theme-detail",function(e){var t=n(this).closest(".available-theme"),i=t.find(".themedetaildiv");(i=!i.length?(i=t.find(".install-theme-info .theme-details")).clone().addClass("themedetaildiv").appendTo(t).hide():i).toggle(),e.preventDefault()})}),jQuery(document).ready(function(l){tb_position=function(){var e=l("#TB_window"),t=l(window).width(),i=l(window).height(),n=1040<t?1040:t,t=0;l("body.admin-bar").length&&(t=28),e.size()&&(e.width(n-50).height(i-45-t),l("#TB_iframeContent").width(n-50).height(i-75-t),e.css({"margin-left":"-"+parseInt((n-50)/2,10)+"px"}),void 0!==document.body.style.maxWidth&&e.css({top:20+t+"px","margin-top":"0"}))},l(window).resize(function(){tb_position()})}),jQuery(function(i){var n,l,a,s;window.postMessage&&(n=i("#theme-installer"),l=n.find(".install-theme-info"),a=n.find(".wp-full-overlay-main"),s=i(document.body),n.on("click",".close-full-overlay",function(e){n.fadeOut(200,function(){a.empty(),s.removeClass("theme-installer-active full-overlay-active")}),e.preventDefault()}),n.on("click",".collapse-sidebar",function(e){n.toggleClass("collapsed").toggleClass("expanded"),e.preventDefault()}),i("#availablethemes").on("click",".install-theme-preview",function(e){var t;l.html(i(this).closest(".installable-theme").find(".install-theme-info").html()),t=l.find(".theme-preview-url").val(),a.html('<iframe src="'+t+'" />'),n.fadeIn(200,function(){s.addClass("theme-installer-active full-overlay-active")}),e.preventDefault()}))}),function(i){ThemeViewer=function(e){return{init:function(){i("#filter-click, #mini-filter-click").unbind("click").click(function(){return i("#filter-click").toggleClass("current"),i("#filter-box").slideToggle(),i("#current-theme").slideToggle(300),!1}),i("#filter-box :checkbox").unbind("click").click(function(){var e=i("#filter-box :checked").length,t=i("#filter-click").text();-1!=t.indexOf("(")&&(t=t.substr(0,t.indexOf("("))),0==e?i("#filter-click").text(t):i("#filter-click").text(t+" ("+e+")")})}}}}(jQuery),jQuery(document).ready(function(e){theme_viewer=new ThemeViewer,theme_viewer.init()}),function(i){ThemeScroller={querying:!1,scrollPollingDelay:500,failedRetryDelay:4e3,outListBottomThreshold:300,init:function(){var e=this;"undefined"!=typeof ajaxurl&&"undefined"!=typeof list_args&&"undefined"!=typeof theme_list_args?(this.nonce=i("#_ajax_fetch_list_nonce").val(),this.nextPage=theme_list_args.paged+1,this.$outList=i("#availablethemes"),this.$spinner=i("div.tablenav.bottom").children(".spinner"),this.$window=i(window),this.$document=i(document),theme_list_args.total_pages>=this.nextPage&&(this.pollInterval=setInterval(function(){return e.poll()},this.scrollPollingDelay))):i(".pagination-links").show()},poll:function(){var e=this.$document.scrollTop()+this.$window.innerHeight();this.querying||e<this.$outList.height()-this.outListBottomThreshold||this.ajax()},process:function(e){void 0!==e?(this.nextPage>theme_list_args.total_pages&&clearInterval(this.pollInterval),this.nextPage<=theme_list_args.total_pages+1&&this.$outList.append(e.rows)):clearInterval(this.pollInterval)},ajax:function(){var t=this;this.querying=!0;var e={action:"fetch-list",paged:this.nextPage,s:theme_list_args.search,tab:theme_list_args.tab,type:theme_list_args.type,_ajax_fetch_list_nonce:this.nonce,"features[]":theme_list_args.features,list_args:list_args};this.$spinner.show(),i.getJSON(ajaxurl,e).done(function(e){t.nextPage++,t.process(e),t.$spinner.hide(),t.querying=!1}).fail(function(){t.$spinner.hide(),t.querying=!1,setTimeout(function(){t.ajax()},t.failedRetryDelay)})}},i(document).ready(function(e){ThemeScroller.init()})}(jQuery);