var tagBox,commentsBox,editPermalink,makeSlugeditClickable,WPSetThumbnailHTML,WPSetThumbnailID,WPRemoveThumbnail,wptitlehint;function array_unique_noempty(t){var s=[];return jQuery.each(t,function(t,e){(e=jQuery.trim(e))&&-1==jQuery.inArray(e,s)&&s.push(e)}),s}!function(c){tagBox={clean:function(t){var e=postL10n.comma;return","!==e&&(t=t.replace(new RegExp(e,"g"),",")),t=t.replace(/\s*,\s*/g,",").replace(/,+/g,",").replace(/[,\s]+$/,"").replace(/^[,\s]+/,""),","!==e&&(t=t.replace(/,/g,e)),t},parseTags:function(t){var e=t.id.split("-check-num-")[1],s=c(t).closest(".tagsdiv"),i=s.find(".the-tags"),n=postL10n.comma,t=i.val().split(n),a=[];return delete t[e],c.each(t,function(t,e){(e=c.trim(e))&&a.push(e)}),i.val(this.clean(a.join(n))),this.quickClicks(s),!1},quickClicks:function(t){var s,e=c(".the-tags",t),i=c(".tagchecklist",t),n=c(t).attr("id");e.length&&(s=e.prop("disabled"),e=e.val().split(postL10n.comma),i.empty(),c.each(e,function(t,e){(e=c.trim(e))&&(e=c("<span />").text(e),s||((t=c('<a id="'+n+"-check-num-"+t+'" class="ntdelbutton">X</a>')).click(function(){tagBox.parseTags(this)}),e.prepend("&nbsp;").prepend(t)),i.append(e))}))},flushTags:function(t,e,s){var i,n=c(".the-tags",t),a=c("input.newtag",t),o=postL10n.comma,l=(e=e||!1)?c(e).text():a.val(),l=(i=n.val())?i+o+l:l;return l=array_unique_noempty((l=this.clean(l)).split(o)).join(o),n.val(l),this.quickClicks(t),e||a.val(""),void 0===s&&a.focus(),!1},get:function(s){var i=s.substr(s.indexOf("-")+1);c.post(ajaxurl,{action:"get-tagcloud",tax:i},function(t,e){0!==t&&"success"==e||(t=wpAjax.broken),t=c('<p id="tagcloud-'+i+'" class="the-tagcloud">'+t+"</p>"),c("a",t).click(function(){return tagBox.flushTags(c(this).closest(".inside").children(".tagsdiv"),this),!1}),c("#"+s).after(t)})},init:function(){var t=this,e=c("div.ajaxtag");c(".tagsdiv").each(function(){tagBox.quickClicks(this)}),c("input.tagadd",e).click(function(){t.flushTags(c(this).closest(".tagsdiv"))}),c("div.taghint",e).click(function(){c(this).css("visibility","hidden").parent().siblings(".newtag").focus()}),c("input.newtag",e).blur(function(){""===this.value&&c(this).parent().siblings(".taghint").css("visibility","")}).focus(function(){c(this).parent().siblings(".taghint").css("visibility","hidden")}).keyup(function(t){if(13==t.which)return tagBox.flushTags(c(this).closest(".tagsdiv")),!1}).keypress(function(t){if(13==t.which)return t.preventDefault(),!1}).each(function(){var t=c(this).closest("div.tagsdiv").attr("id");c(this).suggest(ajaxurl+"?action=ajax-tag-search&tax="+t,{delay:500,minchars:2,multiple:!0,multipleSep:postL10n.comma+" "})}),c("#post").submit(function(){c("div.tagsdiv").each(function(){tagBox.flushTags(this,!1,1)})}),c("a.tagcloud-link").click(function(){return tagBox.get(c(this).attr("id")),c(this).unbind().click(function(){return c(this).siblings(".the-tagcloud").toggle(),!1}),!1})}},commentsBox={st:0,get:function(t,e){var s=this.st;return e=e||20,this.st+=e,this.total=t,c("#commentsdiv .spinner").show(),e={action:"get-comments",mode:"single",_ajax_nonce:c("#add_comment_nonce").val(),p:c("#post_ID").val(),start:s,number:e},c.post(ajaxurl,e,function(t){return t=wpAjax.parseAjaxResponse(t),c("#commentsdiv .widefat").show(),c("#commentsdiv .spinner").hide(),"object"==typeof t&&t.responses[0]?(c("#the-comment-list").append(t.responses[0].data),theList=theExtraList=null,c("a[className*=':']").unbind(),void(commentsBox.st>commentsBox.total?c("#show-comments").hide():c("#show-comments").show().children("a").html(postL10n.showcomm))):void(1!=t?c("#the-comment-list").append('<tr><td colspan="2">'+wpAjax.broken+"</td></tr>"):c("#show-comments").html(postL10n.endcomm))}),!1}},WPSetThumbnailHTML=function(t){c(".inside","#postimagediv").html(t)},WPSetThumbnailID=function(t){var e=c('input[value="_thumbnail_id"]',"#list-table");0<e.size()&&c("#meta\\["+e.attr("id").match(/[0-9]+/)+"\\]\\[value\\]").text(t)},WPRemoveThumbnail=function(t){c.post(ajaxurl,{action:"set-post-thumbnail",post_id:c("#post_ID").val(),thumbnail_id:-1,_ajax_nonce:t,cookie:encodeURIComponent(document.cookie)},function(t){"0"==t?alert(setPostThumbnailL10n.error):WPSetThumbnailHTML(t)})},c(document).on("heartbeat-send.refresh-lock",function(t,e){var s=c("#active_post_lock").val(),i=c("#post_ID").val(),n={};i&&c("#post-lock-dialog").length&&(n.post_id=i,s&&(n.lock=s),e["wp-refresh-post-lock"]=n)}),c(document).on("heartbeat-tick.refresh-lock",function(t,e){var s,i;e["wp-refresh-post-lock"]&&((s=e["wp-refresh-post-lock"]).lock_error?(i=c("#post-lock-dialog")).length&&!i.is(":visible")&&("function"==typeof autosave&&(c(document).on("autosave-disable-buttons.post-lock",function(){i.addClass("saving")}).on("autosave-enable-buttons.post-lock",function(){i.removeClass("saving").addClass("saved"),window.onbeforeunload=null}),autosave()||(window.onbeforeunload=null),autosave=function(){}),s.lock_error.avatar_src&&(e=c('<img class="avatar avatar-64 photo" width="64" height="64" />').attr("src",s.lock_error.avatar_src.replace(/&amp;/g,"&")),i.find("div.post-locked-avatar").empty().append(e)),i.show().find(".currently-editing").text(s.lock_error.text),i.find(".wp-tab-first").focus()):s.new_lock&&c("#active_post_lock").val(s.new_lock))})}(jQuery),function(n){var a,t;function s(){a=!1,window.clearTimeout(t),t=window.setTimeout(function(){a=!0},3e5)}n(document).on("heartbeat-send.wp-refresh-nonces",function(t,e){var s,i;a&&(i=n("#post_ID").val())&&(s=n("#_wpnonce").val())&&(e["wp-refresh-post-nonces"]={post_id:i,post_nonce:s})}).on("heartbeat-tick.wp-refresh-nonces",function(t,e){e=e["wp-refresh-post-nonces"];e&&(s(),e.replace&&n.each(e.replace,function(t,e){n("#"+t).val(e)}),e.heartbeatNonce&&(window.heartbeatSettings.nonce=e.heartbeatNonce))}).ready(function(){s()})}(jQuery),jQuery(document).ready(function(d){var u,t,e,s,i,n,a,o="",l=0,c=d("#content");function r(t){return n.height(Math.max(50,a+t.pageY)+"px"),!1}function p(){var t;n.focus(),d(document).unbind("mousemove",r).unbind("mouseup",p),(t=parseInt(n.css("height"),10))&&50<t&&t<5e3&&setUserSetting("ed_size",t)}postboxes.add_postbox_toggles(pagenow),d("#post-lock-dialog .notification-dialog").on("keydown",function(t){var e;9==t.which&&((e=d(t.target)).hasClass("wp-tab-first")&&t.shiftKey?(d(this).find(".wp-tab-last").focus(),t.preventDefault()):e.hasClass("wp-tab-last")&&!t.shiftKey&&(d(this).find(".wp-tab-first").focus(),t.preventDefault()))}).filter(":visible").find(".wp-tab-first").focus(),"undefined"!=typeof wp&&wp.heartbeat&&d("#post-lock-dialog").length&&wp.heartbeat.interval(15),d("#tagsdiv-post_tag").length?tagBox.init():d("#side-sortables, #normal-sortables, #advanced-sortables").children("div.postbox").each(function(){if(0===this.id.indexOf("tagsdiv-"))return tagBox.init(),!1}),d(".categorydiv").each(function(){var t,n,e,s=d(this).attr("id").split("-");s.shift(),n=s.join("-"),e="category"==n?"cats":n+"_tab",d("a","#"+n+"-tabs").click(function(){var t=d(this).attr("href");return d(this).parent().addClass("tabs").siblings("li").removeClass("tabs"),d("#"+n+"-tabs").siblings(".tabs-panel").hide(),d(t).show(),"#"+n+"-all"==t?deleteUserSetting(e):setUserSetting(e,"pop"),!1}),getUserSetting(e)&&d('a[href="#'+n+'-pop"]',"#"+n+"-tabs").click(),d("#new"+n).one("focus",function(){d(this).val("").removeClass("form-input-tip")}),d("#new"+n).keypress(function(t){13===t.keyCode&&(t.preventDefault(),d("#"+n+"-add-submit").click())}),d("#"+n+"-add-submit").click(function(){d("#new"+n).focus()}),t=function(t){return!!d("#new"+n).val()&&(t.data+="&"+d(":checked","#"+n+"checklist").serialize(),d("#"+n+"-add-submit").prop("disabled",!0),t)},s=function(t,e){var s,i=d("#new"+n+"_parent");d("#"+n+"-add-submit").prop("disabled",!1),"undefined"!=e.parsed.responses[0]&&(s=e.parsed.responses[0].supplemental.newcat_parent)&&(i.before(s),i.remove())},d("#"+n+"checklist").wpList({alt:"",response:n+"-ajax-response",addBefore:t,addAfter:s}),d("#"+n+"-add-toggle").click(function(){return d("#"+n+"-adder").toggleClass("wp-hidden-children"),d('a[href="#'+n+'-all"]',"#"+n+"-tabs").click(),d("#new"+n).focus(),!1}),d("#"+n+"checklist, #"+n+"checklist-pop").on("click",'li.popular-category > label input[type="checkbox"]',function(){var t=d(this),e=t.is(":checked"),s=t.val();s&&t.parents("#taxonomy-"+n).length&&d("#in-"+n+"-"+s+", #in-popular-"+n+"-"+s).prop("checked",e)})}),d("#postcustom").length&&d("#the-list").wpList({addAfter:function(){d("table#list-table").show()},addBefore:function(t){return t.data+="&post_id="+d("#post_ID").val(),t}}),d("#submitdiv").length&&(u=d("#timestamp").html(),t=d("#post-visibility-display").html(),e=function(){var t=d("#post-visibility-select");"public"!=d("input:radio:checked",t).val()?(d("#sticky").prop("checked",!1),d("#sticky-span").hide()):d("#sticky-span").show(),"password"!=d("input:radio:checked",t).val()?d("#password-span").hide():d("#password-span").show()},s=function(){if(!d("#timestampdiv").length)return!0;var t,e=d("#post_status"),s=d('option[value="publish"]',e),i=d("#aa").val(),n=d("#mm").val(),a=d("#jj").val(),o=d("#hh").val(),l=d("#mn").val(),c=new Date(i,n-1,a,o,l),r=new Date(d("#hidden_aa").val(),d("#hidden_mm").val()-1,d("#hidden_jj").val(),d("#hidden_hh").val(),d("#hidden_mn").val()),p=new Date(d("#cur_aa").val(),d("#cur_mm").val()-1,d("#cur_jj").val(),d("#cur_hh").val(),d("#cur_mn").val());return c.getFullYear()!=i||1+c.getMonth()!=n||c.getDate()!=a||c.getMinutes()!=l?(d(".timestamp-wrap","#timestampdiv").addClass("form-invalid"),!1):(d(".timestamp-wrap","#timestampdiv").removeClass("form-invalid"),p<c&&"future"!=d("#original_post_status").val()?(t=postL10n.publishOnFuture,d("#publish").val(postL10n.schedule)):c<=p&&"publish"!=d("#original_post_status").val()?(t=postL10n.publishOn,d("#publish").val(postL10n.publish)):(t=postL10n.publishOnPast,d("#publish").val(postL10n.update)),r.toUTCString()==c.toUTCString()?d("#timestamp").html(u):d("#timestamp").html(t+" <b>"+postL10n.dateFormat.replace("%1$s",d('option[value="'+d("#mm").val()+'"]',"#mm").text()).replace("%2$s",a).replace("%3$s",i).replace("%4$s",o).replace("%5$s",l)+"</b> "),"private"==d("input:radio:checked","#post-visibility-select").val()?(d("#publish").val(postL10n.update),0===s.length?e.append('<option value="publish">'+postL10n.privatelyPublished+"</option>"):s.html(postL10n.privatelyPublished),d('option[value="publish"]',e).prop("selected",!0),d(".edit-post-status","#misc-publishing-actions").hide()):("future"==d("#original_post_status").val()||"draft"==d("#original_post_status").val()?s.length&&(s.remove(),e.val(d("#hidden_post_status").val())):s.html(postL10n.published),e.is(":hidden")&&d(".edit-post-status","#misc-publishing-actions").show()),d("#post-status-display").html(d("option:selected",e).text()),"private"==d("option:selected",e).val()||"publish"==d("option:selected",e).val()?d("#save-post").hide():(d("#save-post").show(),"pending"==d("option:selected",e).val()?d("#save-post").show().val(postL10n.savePending):d("#save-post").show().val(postL10n.saveDraft)),!0)},d(".edit-visibility","#visibility").click(function(){return d("#post-visibility-select").is(":hidden")&&(e(),d("#post-visibility-select").slideDown("fast"),d(this).hide()),!1}),d(".cancel-post-visibility","#post-visibility-select").click(function(){return d("#post-visibility-select").slideUp("fast"),d("#visibility-radio-"+d("#hidden-post-visibility").val()).prop("checked",!0),d("#post_password").val(d("#hidden-post-password").val()),d("#sticky").prop("checked",d("#hidden-post-sticky").prop("checked")),d("#post-visibility-display").html(t),d(".edit-visibility","#visibility").show(),s(),!1}),d(".save-post-visibility","#post-visibility-select").click(function(){var t=d("#post-visibility-select");return t.slideUp("fast"),d(".edit-visibility","#visibility").show(),s(),"public"!=d("input:radio:checked",t).val()&&d("#sticky").prop("checked",!1),o=d("#sticky").prop("checked")?"Sticky":"",d("#post-visibility-display").html(postL10n[d("input:radio:checked",t).val()+o]),!1}),d("input:radio","#post-visibility-select").change(function(){e()}),d("#timestampdiv").siblings("a.edit-timestamp").click(function(){return d("#timestampdiv").is(":hidden")&&(d("#timestampdiv").slideDown("fast"),d("#mm").focus(),d(this).hide()),!1}),d(".cancel-timestamp","#timestampdiv").click(function(){return d("#timestampdiv").slideUp("fast"),d("#mm").val(d("#hidden_mm").val()),d("#jj").val(d("#hidden_jj").val()),d("#aa").val(d("#hidden_aa").val()),d("#hh").val(d("#hidden_hh").val()),d("#mn").val(d("#hidden_mn").val()),d("#timestampdiv").siblings("a.edit-timestamp").show(),s(),!1}),d(".save-timestamp","#timestampdiv").click(function(){return s()&&(d("#timestampdiv").slideUp("fast"),d("#timestampdiv").siblings("a.edit-timestamp").show()),!1}),d("#post").on("submit",function(t){if(!s())return t.preventDefault(),d("#timestampdiv").show(),d("#publishing-action .spinner").hide(),d("#publish").prop("disabled",!1).removeClass("button-primary-disabled"),!1}),d("#post-status-select").siblings("a.edit-post-status").click(function(){return d("#post-status-select").is(":hidden")&&(d("#post-status-select").slideDown("fast"),d(this).hide()),!1}),d(".save-post-status","#post-status-select").click(function(){return d("#post-status-select").slideUp("fast"),d("#post-status-select").siblings("a.edit-post-status").show(),s(),!1}),d(".cancel-post-status","#post-status-select").click(function(){return d("#post-status-select").slideUp("fast"),d("#post_status").val(d("#hidden_post_status").val()),d("#post-status-select").siblings("a.edit-post-status").show(),s(),!1})),d("#edit-slug-box").length&&(editPermalink=function(t){var e,s,i=0,n=d("#editable-post-name"),a=n.html(),o=d("#post_name"),l=o.val(),c=d("#edit-slug-buttons"),r=c.html(),p=d("#editable-post-name-full").html();for(d("#view-post-btn").hide(),c.html('<a href="#" class="save button button-small">'+postL10n.ok+'</a> <a class="cancel" href="#">'+postL10n.cancel+"</a>"),c.children(".save").click(function(){var s=n.children("input").val();return s==d("#editable-post-name-full").text()?d(".cancel","#edit-slug-buttons").click():(d.post(ajaxurl,{action:"sample-permalink",post_id:t,new_slug:s,new_title:d("#title").val(),samplepermalinknonce:d("#samplepermalinknonce").val()},function(t){var e=d("#edit-slug-box");e.html(t),e.hasClass("hidden")&&e.fadeIn("fast",function(){e.removeClass("hidden")}),c.html(r),o.val(s),makeSlugeditClickable(),d("#view-post-btn").show()}),!1)}),d(".cancel","#edit-slug-buttons").click(function(){return d("#view-post-btn").show(),n.html(a),c.html(r),o.val(l),!1}),s=0;s<p.length;++s)"%"==p.charAt(s)&&i++;e=i>p.length/4?"":p,n.html('<input type="text" id="new-post-slug" value="'+e+'" />').children("input").keypress(function(t){t=t.keyCode||0;return 13==t?(c.children(".save").click(),!1):27==t?(c.children(".cancel").click(),!1):void 0}).keyup(function(){o.val(this.value)}).focus()},(makeSlugeditClickable=function(){d("#editable-post-name").click(function(){d("#edit-slug-buttons").children(".edit-slug").click()})})()),"undefined"!=typeof wpWordCount&&(d(document).triggerHandler("wpcountwords",[c.val()]),c.keyup(function(t){t=t.keyCode||t.charCode;return t==l||(13!=t&&8!=l&&46!=l||d(document).triggerHandler("wpcountwords",[c.val()]),l=t),!0})),(wptitlehint=function(t){var e=d("#"+(t=t||"title")),s=d("#"+t+"-prompt-text");""===e.val()&&s.removeClass("screen-reader-text"),s.click(function(){d(this).addClass("screen-reader-text"),e.focus()}),e.blur(function(){""===this.value&&s.removeClass("screen-reader-text")}).focus(function(){s.addClass("screen-reader-text")}).keydown(function(t){s.addClass("screen-reader-text"),d(this).unbind(t)})})(),n=d("textarea#content"),a=null,!n.length||"ontouchstart"in window||(n.css("resize","none"),i=d('<div id="content-resize-handle"><br></div>'),d("#wp-content-wrap").append(i),i.on("mousedown",function(t){return a=n.height()-t.pageY,n.blur(),d(document).mousemove(r).mouseup(p),!1})),"undefined"!=typeof tinymce&&(tinymce.onAddEditor.add(function(t,e){function s(){var t=document.getElementById("content_ifr"),e=t?parseInt(t.style.height,10):0,t=d("#content_tbl tr.mceFirst").height();return!(!e||!t)&&(t=e+t+21,t-=33)}"content"!=e.id||tinymce.isIOS5||(e.onLoadContent.add(function(){var t=document.getElementById("content"),e=t?parseInt(t.style.height,10):0,t=d("#content_tbl tr.mceFirst").height()||33;(!e||e<50||5e3<e)&&(e=360),5e3<getUserSetting("ed_size")&&setUserSetting("ed_size",360),50<(t=e-t+12)&&t<5e3&&(d("#content_tbl").css("height",""),d("#content_ifr").css("height",t+"px"))}),e.onSaveContent.add(function(){var t=s();!t||t<50||5e3<t||d("textarea#content").css("height",t+"px")}),e.onPostRender.add(function(){d("#content_resize").on("mousedown.wp-mce-resize",function(){d(document).on("mouseup.wp-mce-resize",function(){var t;d(document).off("mouseup.wp-mce-resize"),(t=s())&&50<t&&t<5e3&&setUserSetting("ed_size",t)})})}))}),d("#post-formats-select input.post-format").on("change.set-editor-class",function(){var t,e,s=this.id;s&&d(this).prop("checked")&&(t=tinymce.get("content"))&&((e=t.getBody()).className=e.className.replace(/\bpost-format-[^ ]+/,""),t.dom.addClass(e,"post-format-0"==s?"post-format-standard":s))}))});