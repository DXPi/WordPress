var theme_viewer,ThemeViewer,ThemeScroller;jQuery(function(l){l("#availablethemes").on("click",".theme-detail",function(e){var t=l(this).closest(".available-theme"),i=t.find(".themedetaildiv");i.length||(i=(i=t.find(".install-theme-info .theme-details")).clone().addClass("themedetaildiv").appendTo(t).hide()),i.toggle(),e.preventDefault()})}),jQuery(function(i){var l,n,a,s,r;window.postMessage&&(l=i("#theme-installer"),n=l.find(".wp-full-overlay-header"),a=l.find(".install-theme-info"),s=l.find(".wp-full-overlay-main"),r=i(document.body),l.on("click",".close-full-overlay",function(e){l.fadeOut(200,function(){s.empty(),r.removeClass("theme-installer-active full-overlay-active")}),e.preventDefault()}),l.on("click",".collapse-sidebar",function(e){l.toggleClass("collapsed").toggleClass("expanded"),e.preventDefault()}),i("#availablethemes").on("click",".install-theme-preview",function(e){var t;a.html(i(this).closest(".installable-theme").find(".install-theme-info").html()),n.find(".theme-install").replaceWith(a.find(".theme-install")),t=a.find(".theme-preview-url").val(),s.html('<iframe src="'+t+'" />'),l.fadeIn(200,function(){r.addClass("theme-installer-active full-overlay-active")}),e.preventDefault()}))}),function(i){ThemeViewer=function(){return{init:function(){i("#filter-click, #mini-filter-click").unbind("click").click(function(){return i("#filter-click").toggleClass("current"),i("#filter-box").slideToggle(),i("#current-theme").slideToggle(300),!1}),i("#filter-box :checkbox").unbind("click").click(function(){var e=i("#filter-box :checked").length,t=i("#filter-click").text();-1!==t.indexOf("(")&&(t=t.substr(0,t.indexOf("("))),0===e?i("#filter-click").text(t):i("#filter-click").text(t+" ("+e+")")})}}}}(jQuery),jQuery(document).ready(function(){(theme_viewer=new ThemeViewer).init()}),function(i){ThemeScroller={querying:!1,scrollPollingDelay:500,failedRetryDelay:4e3,outListBottomThreshold:300,init:function(){var e=this;"undefined"!=typeof ajaxurl&&"undefined"!=typeof list_args&&"undefined"!=typeof theme_list_args?(this.nonce=i("#_ajax_fetch_list_nonce").val(),this.nextPage=theme_list_args.paged+1,this.$outList=i("#availablethemes"),this.$spinner=i("div.tablenav.bottom").children(".spinner"),this.$window=i(window),this.$document=i(document),theme_list_args.total_pages>=this.nextPage&&(this.pollInterval=setInterval(function(){return e.poll()},this.scrollPollingDelay))):i(".pagination-links").show()},poll:function(){var e=this.$document.scrollTop()+this.$window.innerHeight();this.querying||e<this.$outList.height()-this.outListBottomThreshold||this.ajax()},process:function(e){void 0!==e?(this.nextPage>theme_list_args.total_pages&&clearInterval(this.pollInterval),this.nextPage<=theme_list_args.total_pages+1&&this.$outList.append(e.rows)):clearInterval(this.pollInterval)},ajax:function(){var t=this,e={action:"fetch-list",paged:this.nextPage,s:theme_list_args.search,tab:theme_list_args.tab,type:theme_list_args.type,_ajax_fetch_list_nonce:this.nonce,"features[]":theme_list_args.features,list_args:list_args};this.querying=!0,this.$spinner.show(),i.getJSON(ajaxurl,e).done(function(e){t.nextPage++,t.process(e),t.$spinner.hide(),t.querying=!1}).fail(function(){t.$spinner.hide(),t.querying=!1,setTimeout(function(){t.ajax()},t.failedRetryDelay)})}},i(document).ready(function(){ThemeScroller.init()})}(jQuery);