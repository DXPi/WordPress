!function(u){var i=wp.customize,o=function(n,t,i){var o;return function(){var e=arguments;i=i||this,clearTimeout(o),o=setTimeout(function(){o=null,n.apply(i,e)},t)}};i.Preview=i.Messenger.extend({initialize:function(e,n){var t=this;i.Messenger.prototype.initialize.call(this,e,n),this.body=u(document.body),this.body.on("click.preview","a",function(e){e.preventDefault(),t.send("scroll",0),t.send("url",u(this).prop("href"))}),this.body.on("submit.preview","form",function(e){e.preventDefault()}),this.window=u(window),this.window.on("scroll.preview",o(function(){t.send("scroll",t.window.scrollTop())},200)),this.bind("scroll",function(e){t.window.scrollTop(e)})}}),u(function(){var e;i.settings=window._wpCustomizeSettings,i.settings&&(i.preview=new i.Preview({url:window.location.href,channel:i.settings.channel}),i.preview.bind("settings",function(e){u.each(e,function(e,n){i.has(e)?i(e).set(n):i.create(e,n)})}),i.preview.trigger("settings",i.settings.values),i.preview.bind("setting",function(e){var n;e=e.slice(),(n=i(e.shift()))&&n.set.apply(n,e)}),i.preview.bind("sync",function(e){u.each(e,function(e,n){i.preview.trigger(e,n)}),i.preview.send("synced")}),i.preview.bind("active",function(){i.settings.nonce&&i.preview.send("nonce",i.settings.nonce),i.preview.send("documentTitle",document.title)}),i.preview.send("ready",{activePanels:i.settings.activePanels,activeSections:i.settings.activeSections,activeControls:i.settings.activeControls}),e=u.map(["color","image","position_x","repeat","attachment"],function(e){return"background_"+e}),i.when.apply(i,e).done(function(n,t,i,o,s){var c=u(document.body),r=u("head"),a=u("#custom-background-css"),e=function(){var e="";c.toggleClass("custom-background",!(!n()&&!t())),n()&&(e+="background-color: "+n()+";"),t()&&(e+='background-image: url("'+t()+'");',e+="background-position: top "+i()+";",e+="background-repeat: "+o()+";",e+="background-attachment: "+s()+";"),a.remove(),a=u('<style type="text/css" id="custom-background-css">body.custom-background { '+e+" }</style>").appendTo(r)};u.each(arguments,function(){this.bind(e)})}),i.trigger("preview-ready"))})}((wp,jQuery));