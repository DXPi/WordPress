var gk_media_init = function(selector, button_selector)  {    var clicked_button = false;     jQuery(selector).each(function (i, input) {        var button = jQuery(input).next(button_selector);        button.click(function (event) {            event.preventDefault();            var selected_img;            clicked_button = jQuery(this);             // check for existing media manager instances			 if(wp.media.frames.gk_frame) {				wp.media.frames.gk_frame.open();				return;			}            // configuration for new instance of the media manager			wp.media.frames.gk_frame = wp.media({						   title: 'Select image',						   multiple: false,						   library: {							  type: 'image'						   },						   button: {							  text: 'Use selected image'						   }						});			var gk_media_set_image = function() {			var selection = wp.media.frames.gk_frame.state().get('selection');		 			if (!selection) {				return;			}		 			// iterate through selected elements			selection.each(function(attachment) {				var url = attachment.attributes.url;				clicked_button.prev(selector).val(url);			});		};            // closing event for the media manager			wp.media.frames.gk_frame.on('close', gk_media_set_image);            // selection event for the media manager			wp.media.frames.gk_frame.on('select', gk_media_set_image);            // opening media manager window			wp.media.frames.gk_frame.open();       });   });};